<div class="titulo-auditoria">
  <b><%= @auditoria.checklist.nome %> Â»</b>
</div>
<br /><br /><br /><br /><br /><br />

<div id="mensagens" class="alert alert-error" style="display:none"></div>


<div class="fuelux">

  <div id="MyWizard" class="wizard">
    <ul class="steps">
      <li data-target="#step1" class="active"><span class="badge badge-info">1</span>Step 1<span class="chevron"></span></li>
      <li data-target="#step2"><span class="badge">2</span>Step 2<span class="chevron"></span></li>
      <li data-target="#step3"><span class="badge">3</span>Step 3<span class="chevron"></span></li>
      <li data-target="#step4"><span class="badge">4</span>Step 4<span class="chevron"></span></li>
      <li data-target="#step5"><span class="badge">5</span>Step 5<span class="chevron"></span></li>
    </ul>
    <div class="actions">
      <button type="button" class="btn btn-mini btn-prev"> <i class="icon-arrow-left"></i>Prev</button>
      <button type="button" class="btn btn-mini btn-next" data-last="Finish">Next<i class="icon-arrow-right"></i></button>
    </div>
  </div>

  <div class="step-content">
    <div class="formulario-auditoria">
      <%= form_for [:entidade, @auditoria], remote: true do |f| %>
        <% index = 1 %>
        <% @auditoria.carrega_itens_checklist.each do |item_checklist| %>
          <% item_checklist.item_verificacaos.each do |item_verificacao| %>
            <%= monta_checklist_de_auditoria(item_verificacao, index) %>
            <% index += 1 %>
          <% end %>    
        <% end %>
        <%#= f.submit 'FINALIZAR', class: 'btn btn-inverse finalizar', data: { disable_with: 'FINALIZANDO A PESQUISA...' } %>
        <% if current_user.present? && current_user.permitted_to?(:auditorias, :index) %>
          <%= link_to 'Cancelar', [:entidade, :auditorias], class: 'btn' %>
        <% end %>
      <% end %>
    </div>
  </div>
</div>

<div id="loading" class="modal hide fade" data-show="false" >
  <div class="modal-body">
    <%= image_tag "big-loader.gif" %>
    <br />
    <p>Processando, aguarde!</p>
  </div>
</div>

<script type="text/javascript">
  jQuery(function($) {
    $('body').addClass('layout-auditoria');
    $('.dropdown').remove();
    $('.footer').remove();

    // $("#MyWizard").on('changed', function (e, data) {
    //     $(".step-pane").removeClass('active');
    //     $("#step" + data.step).addClass("active");
    // });

    $('.finalizar').click(function() {
      $('#loading').modal('toggle');  
    });

    $('.botoes-radio').click(function() {
      $('#MyWizard').wizard('next');
      var botao_id = $(this).attr('id');
      var alternativa_id = $(this).attr('id').split('_')[2];
      var hidden_id = botao_id.replace('botao', 'respostas');
      var resposta = hidden_id.split('_')[0] + '_' + hidden_id.split('_')[1];
      var pai_id = $('#' + resposta).attr('id');
      $('#' + pai_id).find('input[type=hidden]').each(function() {
        $(this).val('');
      });
      $('#' + hidden_id).val(alternativa_id);
    });
  });
</script>
